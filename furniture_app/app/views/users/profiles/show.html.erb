<main class="main-container">

  <section id="category">

    <div class="personal-data-cat">

      <div class="icon-cat">
        <%= image_tag "header/user-svgrepo-com.svg", class: "icon-cat-user", alt: "Profile icon" %>
      </div>

      <div class="text-cat">
        <p id="user-first-last-name"><%= "#{current_user.first_name} #{current_user.last_name}" %></p>
        <p id="user-email"><%= current_user.email %></p>
      </div>

    </div>

    <div class="item-cat" id="user-sets-cat">
      <p class="item-cat-title">Мої сети</p>
    </div>

    <div class="item-cat" id="add-item-cat">
      <p class="item-cat-title">Додати товари</p>
    </div>

    <div class="item-cat" id="remove-item-cat" style="display: none">
      <p class="item-cat-title">Видалити товари</p>
    </div>

    <div class="item-cat" id="item-list-cat">
      <p class="item-cat-title">Мої замовлення</p>
    </div>

  </section>

  <section id="category-data">
    <div class="personal-data">

      <h1 class="personal-data-header">Особиста інформація</h1>

      <div class="personal-data-full-name-grid">

        <div class="contact-data-column">
          <p class="personal-data-column-title">Прізвище</p>
          <p class="personal-data-field"><%= current_user.last_name %></p>
        </div>

        <div class="contact-data-column">
          <p class="personal-data-column-title">Ім'я</p>
          <p class="personal-data-field"><%= current_user.first_name %></p>
        </div>

        <div class="contact-data-column">
          <p class="personal-data-column-title">По батькові</p>
          <p class="personal-data-field"><%= current_user.middle_name %></p>
        </div>


        <div class="contact-data-column">
          <p class="personal-data-column-title">Номер телефону</p>
          <p class="contact-data-field"><%= current_user.phone_number %></p>
        </div>

        <div class="contact-data-column">
          <p class="personal-data-column-title">Email</p>
          <p class="contact-data-field"><%= current_user.email %></p>
        </div>


      </div>

      <div class="button-container">
        <button class="change-data-button">Редагувати</button>
      </div>
    </div>

    <div class="user-sets" style="display: none">
      <div id="prod_sets">
        <% @prod_sets.each do |prod_set| %>
          <div class="prod-set">
            <p class="set-name"><%= prod_set.set_name %></p>
            <div class="product-list">
              <% if prod_set.prod_data.present? %>
                <% prod_set.prod_data.each do |product_id, quantity| %>
                  <% product = Product.find(product_id) %>
                  <div class="prod">
                    <p><%= product.prod_model %> x<%= quantity %></p>
                  </div>
                <% end %>
              <% else %>
                <p>В цьому сеті немає продуктів.</p>
              <% end %>
            </div>
          </div>
        <% end %>
        <div class="button-container">
          <%= link_to "Створити сет", new_prod_set_path(user_id: current_user.id), class: "create-set-button" %>
        </div>
      </div>
    </div>

    <div class="add-item">
      <div>
        <% if @sub_categories.present? %>
          <%= label_tag :sub_category_id, "Оберіть категорію", style: "display: block" %>
          <%= select_tag :sub_category_id, options_for_select(@sub_categories.map { |sub_category| [sub_category.subcat_name, sub_category.id] }), id: "sub_category_select" %>
        <% else %>
          <p>Немає доступних товарів</p>
        <% end %>
      </div>

      <div id="products-dropdown">
        <table class="product-table">
          <thead>
          <tr>
            <th></th>
            <th>Модель</th>
            <th>Ціна</th>
            <th>Опис</th>
          </tr>
          </thead>
          <tbody>
          <% if @products.present? %>
          <% @products.each do |product| %>
            <tr>
              <td><%= check_box_tag "product_ids[]", product.id %></td>
              <td><%= product.prod_model %></td>
              <td><%= product.price %></td>
              <td><%= product.description %></td>
            </tr>
          <% end %>
          <% end %>
          </tbody>
        </table>
      </div>
    </div>


    <div class="remove-item">
    </div>

    <div class="item-list">
      <% @orders.each do |order| %>
        <div class="order">
          <p class="order-header">Замовлення №<%= order.id %></p>
          <div class="order-details">
            <p><%= order.product.prod_model %> x<%= order.quantity %></p>
            <p>Сума замовлення: <%= number_to_currency(order.total_price, unit: "₴") %></p>
          </div>
        </div>
      <% end %>
    </div>

  </section>

</main>

<!--<script>-->
<!--    document.addEventListener('turbo:load', function() {-->
<!--        let createButton = document.querySelector(".create-set-button");-->
<!--        let formDiv = document.getElementById("createSetForm");-->
<!--        let overlay = document.getElementById("createSetForm-overlay");-->
<!--        let closeButton = document.querySelector(".close-button");-->

<!--        createButton.addEventListener("click", function(event) {-->
<!--            event.preventDefault();-->
<!--            formDiv.style.display = "block";-->
<!--            overlay.style.display = "block";-->
<!--        });-->

<!--        closeButton.addEventListener("click", function() {-->
<!--            formDiv.style.display = "none";-->
<!--            overlay.style.display = "none";-->
<!--        });-->
<!--    });-->
<!--</script>-->